nohup: ignoring input
filter_sigma: (20, 20, 20)
Operator `Forward` ran in 0.23 s
Operator `Forward` ran in 0.73 s
Operator `Forward` ran in 0.33 s
Operator `Forward` ran in 0.28 s
Operator `Forward` ran in 0.30 s
Operator `Forward` ran in 0.64 s
Operator `Forward` ran in 0.35 s
Operator `Forward` ran in 0.53 s
Operator `Forward` ran in 0.49 s
Operator `Forward` ran in 0.45 s
Operator `Forward` ran in 1.22 s
Operator `Forward` ran in 0.72 s
Operator `Forward` ran in 0.47 s
Operator `Forward` ran in 0.58 s
Operator `Forward` ran in 0.31 s
Operator `Forward` ran in 1.47 s
Operator `Forward` ran in 1.02 s
Operator `Forward` ran in 1.16 s
Operator `Forward` ran in 0.87 s
Operator `Forward` ran in 1.34 s
Operator `Forward` ran in 0.22 s
Operator `Forward` ran in 0.21 s
Operator `Forward` ran in 0.22 s
Operator `Forward` ran in 0.22 s
Operator `Forward` ran in 0.30 s
Operator `Forward` ran in 2.13 s
Operator `Forward` ran in 2.25 s
Operator `Forward` ran in 3.02 s
Operator `Forward` ran in 2.98 s
Operator `Forward` ran in 2.21 s
Operator `Forward` ran in 2.14 s
Operator `Forward` ran in 2.70 s
Operator `Forward` ran in 2.43 s
Operator `Forward` ran in 3.02 s
Operator `Forward` ran in 2.30 s
Operator `Forward` ran in 3.48 s
Operator `Forward` ran in 2.15 s
Operator `Forward` ran in 2.02 s
Operator `Forward` ran in 3.81 s
Operator `Forward` ran in 3.71 s
Operator `Forward` ran in 5.20 s
Operator `Forward` ran in 3.69 s
Operator `Forward` ran in 3.43 s
Operator `Forward` ran in 4.89 s
Operator `Forward` ran in 4.04 s
Operator `Forward` ran in 3.89 s
Operator `Forward` ran in 4.41 s
Operator `Forward` ran in 4.24 s
Operator `Forward` ran in 4.40 s
Operator `Forward` ran in 4.12 s
Operator `Gradient` ran in 0.51 s
Operator `Gradient` ran in 0.45 s
Operator `Gradient` ran in 0.50 s
Operator `Gradient` ran in 0.96 s
Operator `Gradient` ran in 0.71 s
Operator `Gradient` ran in 0.83 s
Operator `Gradient` ran in 1.14 s
Operator `Gradient` ran in 1.94 s
Operator `Gradient` ran in 1.07 s
Operator `Gradient` ran in 1.43 s
Operator `Gradient` ran in 1.86 s
Operator `Gradient` ran in 1.90 s
Operator `Gradient` ran in 2.52 s
Operator `Gradient` ran in 2.57 s
Operator `Gradient` ran in 2.82 s
Operator `Gradient` ran in 2.49 s
Operator `Gradient` ran in 2.78 s
Operator `Gradient` ran in 4.47 s
Operator `Gradient` ran in 2.75 s
Operator `Gradient` ran in 2.74 s
Operator `Gradient` ran in 1.93 s
Operator `Gradient` ran in 4.36 s
Operator `Gradient` ran in 3.48 s
Operator `Gradient` ran in 3.95 s
Operator `Gradient` ran in 2.45 s
Operator `Forward` ran in 4.77 s
Operator `Forward` ran in 4.37 s
Operator `Forward` ran in 5.68 s
Operator `Forward` ran in 5.19 s
Operator `Forward` ran in 4.43 s
Operator `Forward` ran in 5.45 s
Operator `Forward` ran in 6.43 s
Operator `Forward` ran in 6.15 s
Operator `Forward` ran in 4.72 s
Operator `Forward` ran in 6.46 s
Operator `Forward` ran in 4.90 s
Operator `Forward` ran in 8.65 s
Operator `Forward` ran in 8.57 s
Operator `Forward` ran in 6.71 s
Operator `Forward` ran in 8.97 s
Operator `Forward` ran in 10.29 s
Operator `Forward` ran in 9.95 s
Operator `Forward` ran in 9.92 s
Operator `Forward` ran in 10.07 s
Operator `Forward` ran in 10.16 s
Operator `Forward` ran in 9.55 s
Operator `Forward` ran in 9.85 s
Operator `Forward` ran in 9.64 s
Operator `Forward` ran in 10.03 s
Operator `Forward` ran in 9.99 s
Operator `Gradient` ran in 3.71 s
Operator `Gradient` ran in 4.33 s
Operator `Gradient` ran in 4.86 s
Operator `Gradient` ran in 5.31 s
Operator `Gradient` ran in 6.72 s
Operator `Gradient` ran in 6.79 s
Operator `Gradient` ran in 6.52 s
Operator `Gradient` ran in 8.64 s
Operator `Gradient` ran in 5.22 s
Operator `Gradient` ran in 6.43 s
Operator `Gradient` ran in 5.24 s
Operator `Gradient` ran in 5.80 s
Operator `Gradient` ran in 11.58 s
Operator `Gradient` ran in 5.91 s
Operator `Gradient` ran in 5.96 s
Operator `Gradient` ran in 6.10 s
Operator `Gradient` ran in 6.21 s
Operator `Gradient` ran in 10.19 s
Operator `Gradient` ran in 11.64 s
Operator `Gradient` ran in 11.32 s
Operator `Gradient` ran in 8.28 s
Operator `Gradient` ran in 12.34 s
Operator `Gradient` ran in 10.88 s
Operator `Gradient` ran in 7.25 s
Operator `Gradient` ran in 7.04 s
Traceback (most recent call last):
  File "/home/pengyaoguang/1325/Devito/Devito/mul_3DFWI.py", line 208, in <module>
    result = optimize.minimize(loss, m0, args=(model0, geometry0, d_obs), method='L-BFGS-B', jac=True,
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/scipy/optimize/_minimize.py", line 710, in minimize
    res = _minimize_lbfgsb(fun, x0, args, jac, bounds,
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/scipy/optimize/_lbfgsb_py.py", line 367, in _minimize_lbfgsb
    if _call_callback_maybe_halt(callback, intermediate_result):
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/scipy/optimize/_optimize.py", line 175, in _call_callback_maybe_halt
    callback(res)
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/scipy/optimize/_optimize.py", line 150, in wrapped_callback
    return callback(np.copy(res.x))
  File "/home/pengyaoguang/1325/Devito/Devito/mul_3DFWI.py", line 186, in fwi_callback
    plt.savefig("data/devito/FWI/test_result/some_result/v_update{}".format(len(model_error)-1))
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/matplotlib/pyplot.py", line 1023, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/matplotlib/figure.py", line 3343, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2366, in print_figure
    result = print_method(
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/matplotlib/backend_bases.py", line 2232, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 509, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py", line 458, in _print_pil
    mpl.image.imsave(
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/matplotlib/image.py", line 1689, in imsave
    image.save(fname, **pil_kwargs)
  File "/home/pengyaoguang/.conda/envs/pytorch3.9/lib/python3.9/site-packages/PIL/Image.py", line 2429, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'data/devito/FWI/test_result/some_result/v_update0.png'
RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =        15625     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  1.55812D+05    |proj g|=  2.52356D-01

At iterate    1    f=  5.71415D+04    |proj g|=  2.93017D-01
